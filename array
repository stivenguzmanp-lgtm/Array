<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Segundo Parcial - Electiva</title>
</head>
<body>
  <h2>Segundo Parcial - Electiva Tecnológica</h2>
  <p>Docente: Carlos Castro</p>
  <p>Estudiante: (tu nombre aquí)</p>
  <p>Abre la consola del navegador (F12 → Consola) para ver los resultados.</p>

  <script>
    /* ---------------------------------------------
       SEGUNDO PARCIAL - ELECTIVA TECNOLÓGICA
       Docente: Carlos Castro
       Estudiante: (Tu nombre)
       ---------------------------------------------
       Contiene las soluciones a los 5 puntos:
       1. Buscar estudiantes
       2. Gestión de libros
       3. Gestión de estudiantes
       4. Registro de venta
       5. Inventario de productos
    --------------------------------------------- */

    // ----------------------------------------------------------
    // 1️⃣ Buscar objetos en un array (estudiantes)
    // ----------------------------------------------------------
    const estudiantes = [
      { cedula: "1001", nombre: "Ana", apellido: "Pérez", edad: 20 },
      { cedula: "1002", nombre: "Carlos", apellido: "Gómez", edad: 22 },
      { cedula: "1003", nombre: "Laura", apellido: "Rodríguez", edad: 19 }
    ];

    function buscarEstudiante() {
      let cedula = prompt("Ingrese la cédula del estudiante:");
      const encontrado = estudiantes.find(e => e.cedula === cedula);
      if (encontrado) {
        alert(`Estudiante encontrado:\n${encontrado.nombre} ${encontrado.apellido}, edad ${encontrado.edad}`);
      } else {
        alert("No se encontró estudiante con esa cédula.");
      }
    }

    // ----------------------------------------------------------
    // 2️⃣ Programa para agregar y buscar libros
    // ----------------------------------------------------------
    let libros = [];

    function agregarLibro() {
      let titulo = prompt("Título del libro:");
      let autor = prompt("Autor del libro:");
      let anio = prompt("Año de publicación:");
      let isbn = prompt("Código ISBN:");
      let nuevo = { titulo, autor, anio, isbn };
      libros.push(nuevo);
      alert("Libro agregado correctamente.");
    }

    function listarLibros() {
      if (libros.length === 0) {
        alert("No hay libros registrados.");
      } else {
        let lista = "Lista de libros:\n";
        libros.forEach((l, i) => {
          lista += `${i + 1}. ${l.titulo} - ${l.autor} (${l.anio})\n`;
        });
        alert(lista);
      }
    }

    function buscarLibro() {
      let palabra = prompt("Buscar libro por título o autor:");
      const resultado = libros.filter(
        l => l.titulo.toLowerCase().includes(palabra.toLowerCase()) ||
             l.autor.toLowerCase().includes(palabra.toLowerCase())
      );
      if (resultado.length > 0) {
        let texto = "Libros encontrados:\n";
        resultado.forEach(l => {
          texto += `${l.titulo} - ${l.autor}\n`;
        });
        alert(texto);
      } else {
        alert("No se encontraron libros.");
      }
    }

    // ----------------------------------------------------------
    // 3️⃣ Programa para gestionar estudiantes
    // ----------------------------------------------------------
    let listaEstudiantes = [...estudiantes];

    function agregarEstudiante() {
      let cedula = prompt("Cédula del estudiante:");
      if (listaEstudiantes.some(e => e.cedula === cedula)) {
        alert("Ya existe un estudiante con esa cédula.");
        return;
      }
      let nombre = prompt("Nombre:");
      let apellido = prompt("Apellido:");
      let edad = Number(prompt("Edad:"));
      listaEstudiantes.push({ cedula, nombre, apellido, edad });
      alert("Estudiante agregado correctamente.");
    }

    function listarEstudiantes() {
      let ordenados = [...listaEstudiantes].sort((a, b) =>
        a.apellido.localeCompare(b.apellido)
      );
      let texto = "Estudiantes ordenados por apellido:\n";
      ordenados.forEach(e => {
        texto += `${e.apellido}, ${e.nombre} - ${e.cedula}\n`;
      });
      alert(texto);
    }

    function buscarPorCedula() {
      let cedula = prompt("Ingrese la cédula del estudiante:");
      const e = listaEstudiantes.find(e => e.cedula === cedula);
      if (e) {
        alert(`Nombre: ${e.nombre} ${e.apellido}\nEdad: ${e.edad}`);
      } else {
        alert("No se encontró el estudiante.");
      }
    }

    function actualizarEstudiante() {
      let cedula = prompt("Cédula del estudiante a actualizar:");
      const e = listaEstudiantes.find(e => e.cedula === cedula);
      if (!e) {
        alert("No existe ese estudiante.");
        return;
      }
      e.nombre = prompt("Nuevo nombre:", e.nombre);
      e.apellido = prompt("Nuevo apellido:", e.apellido);
      e.edad = Number(prompt("Nueva edad:", e.edad));
      alert("Datos actualizados correctamente.");
    }

    function eliminarEstudiante() {
      let cedula = prompt("Cédula del estudiante a eliminar:");
      const indice = listaEstudiantes.findIndex(e => e.cedula === cedula);
      if (indice >= 0) {
        listaEstudiantes.splice(indice, 1);
        alert("Estudiante eliminado.");
      } else {
        alert("No existe el estudiante.");
      }
    }

    // ----------------------------------------------------------
    // 4️⃣ Registro de venta de productos
    // ----------------------------------------------------------
    const IVA = 0.19;

    function registrarVenta() {
      let continuar = true;
      let subtotal = 0;

      while (continuar) {
        let precio = Number(prompt("Ingrese el precio del producto:"));
        let cantidad = Number(prompt("Ingrese la cantidad:"));
        if (isNaN(precio) || isNaN(cantidad) || precio <= 0 || cantidad <= 0) {
          alert("Datos inválidos, ingrese valores positivos.");
        } else {
          subtotal += precio * cantidad;
        }
        continuar = confirm("¿Desea agregar otro producto?");
      }

      let valorIVA = subtotal * IVA;
      let total = subtotal + valorIVA;
      alert(
        `Subtotal: $${subtotal.toFixed(2)}\n` +
        `IVA (19%): $${valorIVA.toFixed(2)}\n` +
        `Total a pagar: $${total.toFixed(2)}`
      );
    }

    // ----------------------------------------------------------
    // 5️⃣ Inventario de productos
    // ----------------------------------------------------------
    let productos = [];

    function agregarProducto() {
      let codigo = prompt("Código del producto:");
      if (productos.some(p => p.codigo === codigo)) {
        alert("Ya existe un producto con ese código.");
        return;
      }
      let nombre = prompt("Nombre del producto:");
      let precio = Number(prompt("Precio:"));
      let stock = Number(prompt("Cantidad en stock:"));
      if (precio < 0 || stock < 0) {
        alert("Los valores deben ser positivos.");
        return;
      }
      let estado = stock > 0 ? "Disponible" : "Agotado";
      productos.push({ codigo, nombre, precio, stock, estado });
      alert("Producto agregado correctamente.");
    }

    function actualizarStock() {
      let codigo = prompt("Código del producto a actualizar:");
      const producto = productos.find(p => p.codigo === codigo);
      if (!producto) {
        alert("No se encontró el producto.");
        return;
      }
      let nuevoStock = Number(prompt("Nuevo stock:"));
      if (nuevoStock < 0) {
        alert("El stock no puede ser negativo.");
        return;
      }
      producto.stock = nuevoStock;
      producto.estado = nuevoStock > 0 ? "Disponible" : "Agotado";
      alert("Stock actualizado correctamente.");
    }

    function listarProductos() {
      let ordenados = [...productos].sort((a, b) =>
        a.nombre.localeCompare(b.nombre)
      );
      let texto = "Lista de productos:\n";
      ordenados.forEach(p => {
        texto += `${p.codigo} - ${p.nombre} ($${p.precio}) - ${p.estado}\n`;
      });
      alert(texto);
    }

    // ----------------------------------------------------------
    // Menú principal
    // ----------------------------------------------------------
    function menu() {
      let opcion;
      do {
        opcion = prompt(
          "SEGUNDO PARCIAL ELECTIVA\n\n" +
          "1. Buscar estudiante en array\n" +
          "2. Agregar libro\n" +
          "3. Listar libros\n" +
          "4. Buscar libro\n" +
          "5. Agregar estudiante\n" +
          "6. Listar estudiantes\n" +
          "7. Buscar estudiante\n" +
          "8. Actualizar estudiante\n" +
          "9. Eliminar estudiante\n" +
          "10. Registrar venta\n" +
          "11. Agregar producto\n" +
          "12. Actualizar stock\n" +
          "13. Listar productos\n" +
          "0. Salir"
        );

        switch (opcion) {
          case "1": buscarEstudiante(); break;
          case "2": agregarLibro(); break;
          case "3": listarLibros(); break;
          case "4": buscarLibro(); break;
          case "5": agregarEstudiante(); break;
          case "6": listarEstudiantes(); break;
          case "7": buscarPorCedula(); break;
          case "8": actualizarEstudiante(); break;
          case "9": eliminarEstudiante(); break;
          case "10": registrarVenta(); break;
          case "11": agregarProducto(); break;
          case "12": actualizarStock(); break;
          case "13": listarProductos(); break;
        }
      } while (opcion !== "0");

      alert("Programa finalizado.");
    }

    // Ejecutar menú
    menu();
  </script>
</body>
</html>
